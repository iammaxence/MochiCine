{"ast":null,"code":"var _jsxFileName = \"/home/neko/git/MochiCine/React/src/ListMessages.js\";\nimport React from 'react';\nimport EcrireMessage from './EcrireMessage';\nimport axios from \"axios\";\n\nclass ListMessages extends React.Component {\n  constructor(props) {\n    super(props); //titre, login\n\n    this.state = {\n      messages: [],\n      statut: \"\",\n      textError: \"\",\n      taille: 0\n    };\n    this.addMessage = this.addMessage.bind(this);\n    this.supprimerMessage = this.supprimerMessage.bind(this);\n  }\n\n  componentDidMount() {\n    const url = new URLSearchParams();\n    url.append('titre', this.props.titre);\n    axios.get('http://localhost:8080/MochiCine/Message/List?' + url).then(response => this.lister(response));\n  }\n\n  lister(rep) {\n    console.log(rep.data);\n\n    if (rep.data != null) {\n      if (rep.data[\"code\"]) {\n        this.setState({\n          statut: \"error\",\n          textError: rep.data[\"message\"]\n        });\n        window.confirm(this.state.textError);\n      } else {\n        this.setState({\n          messages: rep.data[\"data\"],\n          taille: rep.data[\"data\"].length\n        });\n      }\n    }\n  } //Ajout d'un message:\n\n\n  addMessage(msg) {\n    if (msg.length > 0) {\n      const url = new URLSearchParams();\n      url.append('login', this.props.login);\n      url.append('titre', this.props.titre);\n      url.append('text', msg);\n      axios.get('http://localhost:8080/MochiCine/Message/Add?' + url).then(response => this.updateMessage(response));\n    }\n  }\n\n  updateMessage(rep) {\n    console.log(\"addMessage: \", rep.data);\n\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"message\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      //Ajout en tete de liste\n      let newList = [];\n      newList.push(rep.data[\"message\"]);\n      this.state.messages.map(item => newList.push(item));\n      this.setState({\n        messages: newList\n      });\n    }\n  } //Suppression d'un message:\n\n\n  supprimerMessage(id_message, index) {\n    if (window.confirm(\"Voulez-vous supprimer ce message ?\")) {\n      const url = new URLSearchParams();\n      url.append('id_message', id_message);\n      axios.get('http://localhost:8080/MochiCine/Message/Delete?' + url).then(response => this.delete(response, index));\n    }\n  }\n\n  delete(rep, index) {\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"message\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      const newList = Object.assign([], this.state.messages);\n      newList.splice(index, 1);\n      this.setState({\n        messages: newList\n      });\n    }\n  }\n\n  getListMessage() {\n    if (this.state.taille != 0) {\n      return this.state.messages.map((item, index) => /*#__PURE__*/React.createElement(\"div\", {\n        key: item.key,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 7\n        }\n      }, \"index\")));\n    }\n  }\n\n  render() {\n    let box = /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    });\n\n    if (this.props.isConnected === true) {\n      box = /*#__PURE__*/React.createElement(EcrireMessage, {\n        addMessage: this.addMessage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 18\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"liste_message\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 4\n      }\n    }, box, this.getListMessage());\n  }\n\n}\n\nexport default ListMessages;","map":{"version":3,"sources":["/home/neko/git/MochiCine/React/src/ListMessages.js"],"names":["React","EcrireMessage","axios","ListMessages","Component","constructor","props","state","messages","statut","textError","taille","addMessage","bind","supprimerMessage","componentDidMount","url","URLSearchParams","append","titre","get","then","response","lister","rep","console","log","data","setState","window","confirm","length","msg","login","updateMessage","newList","push","map","item","id_message","index","delete","Object","assign","splice","getListMessage","key","render","box","isConnected"],"mappings":"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","sourcesContent":["import React from 'react';\nimport EcrireMessage from './EcrireMessage';\nimport axios from \"axios\";\n\n\nclass ListMessages extends React.Component {\n\tconstructor(props){\n    \tsuper(props); //titre, login\n    \tthis.state={messages:[], statut: \"\", textError: \"\", taille : 0};\n    \tthis.addMessage = this.addMessage.bind(this);\n    \tthis.supprimerMessage = this.supprimerMessage.bind(this);\n\n\t}\n\tcomponentDidMount(){\n\t\tconst url = new URLSearchParams();\n \t\turl.append('titre', this.props.titre);\n \t\taxios.get('http://localhost:8080/MochiCine/Message/List?' + url).then(response => this.lister(response));\n\t}\n\n\tlister(rep){\n\t\t  console.log(rep.data);\n\t\t  if(rep.data != null){\n\t\t\tif(rep.data[\"code\"]){\n\t\t\t\tthis.setState ({statut: \"error\", textError: rep.data[\"message\"]});\n\t\t\t\twindow.confirm(this.state.textError);\n\t\t\t}else{\n\t\t\t\tthis.setState({messages: rep.data[\"data\"], taille : rep.data[\"data\"].length});\n\t\t\t} \n\t\t}\n \t}\n\n\n \t//Ajout d'un message:\n\taddMessage(msg){\n\t\tif(msg.length >0){\n\t\t\tconst url = new URLSearchParams();\n \t\t\turl.append('login',this.props.login);\n \t\t\turl.append('titre', this.props.titre);\n \t\t\turl.append('text', msg);\n \t\t\taxios.get('http://localhost:8080/MochiCine/Message/Add?' + url).then(response => this.updateMessage(response));\n\t\t\n\t\t}\n\t}\n\tupdateMessage(rep){\n\t\tconsole.log(\"addMessage: \", rep.data);\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"message\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t  \t\t//Ajout en tete de liste\n\t  \t\tlet newList = [];\n\t  \t\tnewList.push(rep.data[\"message\"])\n\t  \t\tthis.state.messages.map((item) => newList.push(item));\n\t\t\tthis.setState({messages: newList});\n\t  \t}\n\n\t}\n\n\t//Suppression d'un message:\n\tsupprimerMessage(id_message, index){\n\t\tif(window.confirm(\"Voulez-vous supprimer ce message ?\")){\n\t\t\tconst url = new URLSearchParams();\n \t\t\turl.append('id_message', id_message);\n \t\t\taxios.get('http://localhost:8080/MochiCine/Message/Delete?' + url).then(response => this.delete(response, index));\n\t\t}\n    }\n    \n\tdelete(rep, index){\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"message\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t  \t\tconst newList = Object.assign([], this.state.messages);\n\t  \t\tnewList.splice(index,1);\n\t  \t\tthis.setState({messages: newList});\n\t  \t}\n\t}\n\n\n\tgetListMessage(){\n\t\tif(this.state.taille != 0){\n\t\t\treturn(this.state.messages.map((item, index) => \n\t\t\t\t\t<div key={item.key}>\n\t\t\t\t\t\t<p>index</p>\n\t\t\t\t\t</div>));\n\t\t}\n\t}\n\n\trender(){\n\t\tlet box = <div></div>;\n        if(this.props.isConnected === true){\n            box =<EcrireMessage  addMessage={this.addMessage} />\n        }\n\n\t\treturn(\n\t\t\t<div className=\"liste_message\">\n\t\t\t\t{box}\n\t\t\t\t{this.getListMessage()}\n\n\t\t\t</div>\t\n        );\n\t}\n}\n\nexport default ListMessages;"]},"metadata":{},"sourceType":"module"}