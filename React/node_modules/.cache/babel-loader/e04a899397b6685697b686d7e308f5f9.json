{"ast":null,"code":"var _jsxFileName = \"/home/neko/git/MochiCine/React/src/Commentaires.js\";\nimport React from 'react';\nimport axios from \"axios\";\nimport EcrireMessage from \"./EcrireMessage\";\n\nclass Commentaires extends React.Component {\n  constructor(props) {\n    super(props); //login, id_message, comments, isconnected\n\n    this.state = {\n      comments: [],\n      statut: \"\",\n      textError: \"\",\n      taille: 0\n    };\n    this.deleteMessage = this.deleteMessage.bind(this);\n  } //Mettre a jour s'il y a un changement dans la liste de commentaire\n\n\n  componentDidMount() {\n    this.setState({\n      comments: this.props.comments\n    });\n  } //Gestion Commentaire:\n\n\n  addComment(comment) {\n    if (comment.length > 0) {\n      const url = new URLSearchParams();\n      url.append('user', this.props.login);\n      url.append('id_message', this.props.id_message);\n      url.append('comment', comment);\n      axios.get('http://localhost:8080/MochiCine/Comment/Add?' + url).then(response => this.updateComment(response));\n    }\n  }\n\n  updateComment(rep) {\n    console.log(\"addComment\", rep.data);\n\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"commentaire\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      this.state.comments.push(rep.data[\"comment\"]);\n      this.setState({\n        taille: this.state.taille + 1\n      });\n    }\n  } //String id_commentaire, String id_message\n\n\n  deleteMessage(id_commentaire, index) {\n    if (window.confirm(\"Voulez-vous supprimer ce commentaire ?\")) {\n      const url = new URLSearchParams();\n      url.append('id_message', this.props.id_message);\n      url.append('idCom', id_commentaire);\n      axios.get('http://localhost:8080/MochiCine/Comment/Delete?' + url).then(response => this.delete(response, index));\n    }\n  }\n\n  delete(rep, index) {\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"message\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      //Cela permet de faire une copie de notre liste de message:\n      const newList = Object.assign([], this.state.comments);\n      newList.splice(index, 1); //console.log(\"deleteCommentaire: \",newList);\n\n      this.setState({\n        comments: newList\n      });\n    }\n  }\n\n  getListCommentaires() {\n    if (this.state.taille !== 0) {\n      return this.state.comments.map((item, index) => /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        className: \"list-group-item\",\n        key: item._id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"small\", {\n        className: \"date text-muted\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 15\n        }\n      }, item.date), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(\"small\", {\n        className: \"list-group-item-heading text-primary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 7\n        }\n      }, item.login), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"list-group-item-text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 7\n        }\n      }, item.commentaire), this.props.login === item.login ? /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-sm \",\n        onClick: () => this.deleteMessage(item._id, index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 43\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-trash-alt\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 126\n        }\n      })) : /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 174\n        }\n      })))));\n    }\n  }\n\n  render() {\n    let name = \"collapseCom\" + this.props.id_message;\n    let box;\n    this.props.isConnected === true ? box = /*#__PURE__*/React.createElement(EcrireMessage, {\n      addMessage: this.addComment.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 44\n      }\n    }) : box = /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 110\n      }\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"comments-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 3\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn fas fa-comment\",\n      \"data-toggle\": \"collapse\",\n      \"data-target\": \"#\" + name,\n      \"aria-expanded\": \"false\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 4\n      }\n    }), \"\\xA0\\xA0\\xA0\\xA0\", /*#__PURE__*/React.createElement(\"div\", {\n      className: \"collapse\",\n      id: name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 4\n      }\n    }, this.getListCommentaires(), box));\n  }\n\n}\n\nexport default Commentaires;","map":{"version":3,"sources":["/home/neko/git/MochiCine/React/src/Commentaires.js"],"names":["React","axios","EcrireMessage","Commentaires","Component","constructor","props","state","comments","statut","textError","taille","deleteMessage","bind","componentDidMount","setState","addComment","comment","length","url","URLSearchParams","append","login","id_message","get","then","response","updateComment","rep","console","log","data","window","confirm","push","id_commentaire","index","delete","newList","Object","assign","splice","getListCommentaires","map","item","_id","date","commentaire","render","name","box","isConnected"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from \"axios\";\nimport EcrireMessage from \"./EcrireMessage\";\n\n\n\nclass Commentaires extends React.Component {\n\tconstructor(props){\n    \tsuper(props); //login, id_message, comments, isconnected\n    \tthis.state={comments:[], statut:\"\", textError:\"\", taille: 0};\n    \tthis.deleteMessage=this.deleteMessage.bind(this);\n\t}\n\n\t//Mettre a jour s'il y a un changement dans la liste de commentaire\n\tcomponentDidMount(){\n\t\tthis.setState({comments: this.props.comments});\n\t}\n\n\t//Gestion Commentaire:\n\taddComment(comment){\n\t\tif(comment.length >0){\n\t\t\tconst url = new URLSearchParams();\n \t\t\turl.append('user',this.props.login);\n \t\t\turl.append('id_message', this.props.id_message);\n \t\t\turl.append('comment', comment);\n \t\t\taxios.get('http://localhost:8080/MochiCine/Comment/Add?' + url).then(response => this.updateComment(response));\n\t\t}\n\t}\n\tupdateComment(rep){\n\t\tconsole.log(\"addComment\",rep.data)\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"commentaire\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t\t\t  this.state.comments.push(rep.data[\"comment\"]);\n\t\t\t  this.setState({taille: (this.state.taille + 1)});\n\t  \t}\n\t}\n\n\t//String id_commentaire, String id_message\n\tdeleteMessage(id_commentaire, index){\n\t\tif(window.confirm(\"Voulez-vous supprimer ce commentaire ?\")){\n\t\t\tconst url = new URLSearchParams();\n            url.append('id_message', this.props.id_message);\n            url.append('idCom', id_commentaire);\n \t\t\taxios.get('http://localhost:8080/MochiCine/Comment/Delete?' + url).then(response => this.delete(response, index));\n\t\t}\n\t}\n\tdelete(rep, index){\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"message\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t  \t\t//Cela permet de faire une copie de notre liste de message:\n\t  \t\tconst newList = Object.assign([], this.state.comments);\n\t  \t\tnewList.splice(index,1);\n\t  \t\t//console.log(\"deleteCommentaire: \",newList);\n\t  \t\tthis.setState({comments: newList});\n\t  \t}\n\t}\n\n\tgetListCommentaires(){\n\t\tif(this.state.taille !== 0){\n\t\t\treturn(\n\t\t\t\tthis.state.comments.map((item, index) => \n\t\t\t\t<div>\n\t\t\t\t<li className=\"list-group-item\" key={item._id}>\n            \t\t<small className=\"date text-muted\">{item.date}</small>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<small className=\"list-group-item-heading text-primary\">{item.login}</small>\n\t\t\t\t\t\t<p className=\"list-group-item-text\">\n\t\t\t\t\t\t\t{item.commentaire}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t{(this.props.login === item.login)? <button className=\"btn btn-sm \" onClick={()=> this.deleteMessage(item._id, index)}><i className=\"fas fa-trash-alt\"></i></button> : <p></p>}\n\t\t\t\t\t</div>\n\n\t\t\t\t</li>\n\t\t\t\t</div>\n\t\t\t\t\t));\n\t\t\t}\n\t}\n\n\n\n\trender(){\n\t\tlet name = \"collapseCom\"+this.props.id_message;\n\t\tlet box;\n\t\t(this.props.isConnected === true)? box = <EcrireMessage addMessage={this.addComment.bind(this)} /> : box = <div></div>;\n\t\treturn(\n\t\t<div className=\"comments-group\" >\n\t\t\t<button className=\"btn fas fa-comment\" data-toggle=\"collapse\" data-target={\"#\"+name} aria-expanded=\"false\">\n\t\t\t</button>\n\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t<div className=\"collapse\" id={name}>\n\t\t\t\t{this.getListCommentaires()}\n\t\t\t\t{box}\n\t\t\t</div>\n\t\t</div>\n);\n\t}\n}\n\nexport default Commentaires"]},"metadata":{},"sourceType":"module"}