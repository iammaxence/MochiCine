{"ast":null,"code":"var _jsxFileName = \"/home/neko/git/MochiCine/React/src/ListMessages.js\";\nimport React from 'react';\nimport EcrireMessage from './EcrireMessage';\nimport axios from \"axios\";\n\nclass ListMessages extends React.Component {\n  constructor(props) {\n    super(props); //titre, login\n\n    this.state = {\n      messages: [],\n      statut: \"\",\n      textError: \"\",\n      taille: 0\n    };\n    this.addMessage = this.addMessage.bind(this);\n    this.supprimerMessage = this.supprimerMessage.bind(this);\n  }\n\n  componentDidMount() {\n    const url = new URLSearchParams();\n    url.append('titre', this.props.titre);\n    axios.get('http://localhost:8080/MochiCine/Message/List?' + url).then(response => this.lister(response));\n  }\n\n  lister(rep) {\n    console.log(rep.data);\n\n    if (rep.data != null) {\n      if (rep.data[\"code\"]) {\n        this.setState({\n          statut: \"error\",\n          textError: rep.data[\"message\"]\n        });\n        window.confirm(this.state.textError);\n      } else {\n        this.setState({\n          messages: rep.data[\"data\"],\n          taille: rep.data[\"data\"].length\n        });\n      }\n    }\n  } //Ajout d'un message:\n\n\n  addMessage(msg) {\n    if (msg.length > 0) {\n      try {\n        const url = new URLSearchParams();\n        url.append('login', this.props.login);\n        url.append('titre', this.props.titre);\n        url.append('text', msg);\n        axios.get('http://localhost:8080/MochiCine/Message/Add?' + url).then(response => this.updateMessage(response));\n      } catch (error) {\n        console.log(\"Axios Ajout de message\");\n      }\n    }\n  }\n\n  updateMessage(rep) {\n    console.log(\"addMessage: \", rep.data);\n\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"message\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      this.state.messages.unshift(rep.data[\"message\"]);\n      this.setState({\n        taille: this.state.taille + 1\n      });\n    }\n  } //Suppression d'un message:\n\n\n  supprimerMessage(id_message, index) {\n    if (window.confirm(\"Voulez-vous supprimer ce message ?\")) {\n      const url = new URLSearchParams();\n      url.append('id_message', id_message);\n      axios.get('http://localhost:8080/MochiCine/Message/Delete?' + url).then(response => this.delete(response, index));\n    }\n  }\n\n  delete(rep, index) {\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"message\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      const newList = Object.assign([], this.state.messages);\n      newList.splice(index, 1);\n      this.setState({\n        messages: newList\n      });\n    }\n  }\n\n  getListMessage() {\n    if (this.state.taille != 0) {\n      return this.state.messages.map((item, index) => /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-13 container divmes\",\n        key: item._id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"pseudo\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }\n      }, \" \", item.login)), /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }\n      }, item.text), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 7\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"datemess\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }\n      }, item.date), this.props.login === item.login ? /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: () => this.supprimerMessage(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 49\n        }\n      }, \" delete\") : /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 131\n        }\n      }, \"NOTHING\")));\n    }\n  }\n\n  render() {\n    let box;\n    this.props.isConnected === true ? box = /*#__PURE__*/React.createElement(EcrireMessage, {\n      addMessage: this.addMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 49\n      }\n    }) : box = /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 105\n      }\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"liste_message\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 4\n      }\n    }, box, this.getListMessage());\n  }\n\n}\n\nexport default ListMessages;","map":{"version":3,"sources":["/home/neko/git/MochiCine/React/src/ListMessages.js"],"names":["React","EcrireMessage","axios","ListMessages","Component","constructor","props","state","messages","statut","textError","taille","addMessage","bind","supprimerMessage","componentDidMount","url","URLSearchParams","append","titre","get","then","response","lister","rep","console","log","data","setState","window","confirm","length","msg","login","updateMessage","error","unshift","id_message","index","delete","newList","Object","assign","splice","getListMessage","map","item","_id","text","date","render","box","isConnected"],"mappings":"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","sourcesContent":["import React from 'react';\nimport EcrireMessage from './EcrireMessage';\nimport axios from \"axios\";\n\n\nclass ListMessages extends React.Component {\n\tconstructor(props){\n    \tsuper(props); //titre, login\n    \tthis.state={messages:[], statut: \"\", textError: \"\", taille : 0};\n    \tthis.addMessage = this.addMessage.bind(this);\n    \tthis.supprimerMessage = this.supprimerMessage.bind(this);\n\n\t}\n\tcomponentDidMount(){\n\t\tconst url = new URLSearchParams();\n \t\turl.append('titre', this.props.titre);\n \t\taxios.get('http://localhost:8080/MochiCine/Message/List?' + url).then(response => this.lister(response));\n\t}\n\n\tlister(rep){\n\t\t  console.log(rep.data);\n\t\t  if(rep.data != null){\n\t\t\tif(rep.data[\"code\"]){\n\t\t\t\tthis.setState ({statut: \"error\", textError: rep.data[\"message\"]});\n\t\t\t\twindow.confirm(this.state.textError);\n\t\t\t}else{\n\t\t\t\tthis.setState({messages: rep.data[\"data\"], taille : rep.data[\"data\"].length});\n\t\t\t} \n\t\t}\n \t}\n\n\n \t//Ajout d'un message:\n\taddMessage(msg){\n\t\tif(msg.length >0){\n\t\t\ttry{\n\t\t\t\tconst url = new URLSearchParams();\n\t\t\t\turl.append('login',this.props.login);\n\t\t\t\turl.append('titre', this.props.titre);\n\t\t\t\turl.append('text', msg);\n\t\t\t\taxios.get('http://localhost:8080/MochiCine/Message/Add?' + url).then(response => this.updateMessage(response));\n\t\t\t}catch(error){\n\t\t\t\tconsole.log(\"Axios Ajout de message\")\n\t\t\t}\n\t\t}\n\t}\n\tupdateMessage(rep){\n\t\tconsole.log(\"addMessage: \", rep.data);\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"message\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t\t\tthis.state.messages.unshift(rep.data[\"message\"]);\n\t\t\tthis.setState({ taille : (this.state.taille+1)});\t\t\n\t  \t}\n\n\t}\n\n\t//Suppression d'un message:\n\tsupprimerMessage(id_message, index){\n\t\tif(window.confirm(\"Voulez-vous supprimer ce message ?\")){\n\t\t\tconst url = new URLSearchParams();\n \t\t\turl.append('id_message', id_message);\n \t\t\taxios.get('http://localhost:8080/MochiCine/Message/Delete?' + url).then(response => this.delete(response, index));\n\t\t}\n    }\n    \n\tdelete(rep, index){\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"message\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t  \t\tconst newList = Object.assign([], this.state.messages);\n\t  \t\tnewList.splice(index,1);\n\t  \t\tthis.setState({messages: newList});\n\t  \t}\n\t}\n\n\n\tgetListMessage(){\n\t\tif(this.state.taille != 0){\n\t\t\treturn(\n\t\t\t\tthis.state.messages.map((item, index) => \n\t\t\t\t\t<div className=\"col-md-13 container divmes\" key={item._id}>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t    \t<span className=\"pseudo\"> {item.login}</span>\n\t\t\t\t\t    </p>\n\t\t\t\t        <span>{item.text}</span>\n\t\t\t\t\t\t<p/>\n\t\t\t\t        <span className=\"datemess\">{item.date}</span>\n\t\t\t\t        {(this.props.login === item.login)? <button className=\"btn\" onClick={()=> this.supprimerMessage()}> delete</button> : <p>NOTHING</p>}\n\n\n\t\t\t\t\t</div>));\n\t\t}\n\t}\n\n\trender(){\n\t\tlet box;\n        (this.props.isConnected === true)? box =<EcrireMessage  addMessage={this.addMessage} /> : box = <div></div>;\n\n\t\treturn(\n\t\t\t<div className=\"liste_message\">\n\t\t\t\t{box}\n\t\t\t\t{this.getListMessage()}\n\n\t\t\t</div>\t\n        );\n\t}\n}\n\nexport default ListMessages;"]},"metadata":{},"sourceType":"module"}