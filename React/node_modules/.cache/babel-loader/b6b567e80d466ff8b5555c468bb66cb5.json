{"ast":null,"code":"var _jsxFileName = \"/home/neko/git/MochiCine/React/src/Commentaires.js\";\nimport React from 'react';\nimport axios from \"axios\";\nimport EcrireMessage from \"./EcrireMessage\";\n\nclass Commentaires extends React.Component {\n  constructor(props) {\n    super(props); //login, id_message, comments, isconnected\n\n    this.state = {\n      comments: [],\n      statut: \"\",\n      textError: \"\",\n      taille: 0\n    };\n    this.deleteMessage = this.deleteMessage.bind(this);\n  } //Mettre a jour s'il y a un changement dans la liste de commentaire\n\n\n  componentDidMount() {\n    this.setState({\n      comments: this.props.comments\n    });\n  } //Gestion Commentaire:\n\n\n  addComment(comment) {\n    if (comment.length > 0) {\n      const url = new URLSearchParams();\n      url.append('user', this.props.login);\n      url.append('id_message', this.props.id_message);\n      url.append('comment', comment);\n      axios.get('http://localhost:8080/MochiCine/Comment/Add?' + url).then(response => this.updateComment(response));\n    }\n  }\n\n  updateComment(rep) {\n    //console.log(rep.data)\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"commentaire\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      this.state.comments.unshift(rep.data[\"comment\"]);\n    }\n  }\n\n  deleteMessage(id_commentaire, index) {\n    if (window.confirm(\"Voulez-vous supprimer ce commentaire ?\")) {\n      const url = new URLSearchParams();\n      url.append('id_message', this.props.id_message);\n      url.append('comId', id_commentaire);\n      axios.get('http://localhost:8080/MochiCine/Comment/Delete?' + url).then(response => this.delete(response, index));\n    }\n  }\n\n  delete(rep, index) {\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"message\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      //Cela permet de faire une copie de notre liste de message:\n      const newList = Object.assign([], this.state.comments);\n      newList.splice(index, 1); //console.log(\"deleteCommentaire: \",newList);\n\n      this.setState({\n        comments: newList\n      });\n    }\n  }\n\n  getListCommentaires() {\n    return this.state.comments.map((item, index) => /*#__PURE__*/React.createElement(\"li\", {\n      className: \"list-group-item\",\n      key: item._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"small\", {\n      className: \"date text-muted\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 15\n      }\n    }, item.date), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(\"small\", {\n      className: \"list-group-item-heading text-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 7\n      }\n    }, item.login), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"list-group-item-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 7\n      }\n    }, item.text), this.props.login === item.login ? /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-sm corbeille\",\n      onClick: () => this.supprimerMessage(item._id, index),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 43\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-trash-alt\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 138\n      }\n    })) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 186\n      }\n    }))));\n  }\n\n  render() {\n    let name = \"collapseCom\" + this.props.id_message;\n    let box;\n    this.props.isConnected === true ? box = /*#__PURE__*/React.createElement(EcrireMessage, {\n      addMessage: this.addComment.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 44\n      }\n    }) : box = /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 110\n      }\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"comments-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 3\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn fas fa-comment\",\n      \"data-toggle\": \"collapse\",\n      \"data-target\": \"#collapseCom\",\n      \"aria-expanded\": \"false\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 4\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"collapse\",\n      id: \"collapseCom\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 4\n      }\n    }, this.getListCommentaires(), box));\n  }\n\n}\n\nexport default Commentaires;","map":{"version":3,"sources":["/home/neko/git/MochiCine/React/src/Commentaires.js"],"names":["React","axios","EcrireMessage","Commentaires","Component","constructor","props","state","comments","statut","textError","taille","deleteMessage","bind","componentDidMount","setState","addComment","comment","length","url","URLSearchParams","append","login","id_message","get","then","response","updateComment","rep","data","window","confirm","unshift","id_commentaire","index","delete","newList","Object","assign","splice","getListCommentaires","map","item","_id","date","text","supprimerMessage","render","name","box","isConnected"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from \"axios\";\nimport EcrireMessage from \"./EcrireMessage\";\n\n\n\nclass Commentaires extends React.Component {\n\tconstructor(props){\n    \tsuper(props); //login, id_message, comments, isconnected\n    \tthis.state={comments:[], statut:\"\", textError:\"\", taille: 0};\n    \tthis.deleteMessage=this.deleteMessage.bind(this);\n\t}\n\n\t//Mettre a jour s'il y a un changement dans la liste de commentaire\n\tcomponentDidMount(){\n\t\tthis.setState({comments: this.props.comments});\n\t}\n\n\t//Gestion Commentaire:\n\taddComment(comment){\n\t\tif(comment.length >0){\n\t\t\tconst url = new URLSearchParams();\n \t\t\turl.append('user',this.props.login);\n \t\t\turl.append('id_message', this.props.id_message);\n \t\t\turl.append('comment', comment);\n \t\t\taxios.get('http://localhost:8080/MochiCine/Comment/Add?' + url).then(response => this.updateComment(response));\n\t\t}\n\t}\n\tupdateComment(rep){\n\t\t//console.log(rep.data)\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"commentaire\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t  \t\tthis.state.comments.unshift(rep.data[\"comment\"]);\n\t  \t}\n\t}\n\n\n\tdeleteMessage(id_commentaire, index){\n\t\tif(window.confirm(\"Voulez-vous supprimer ce commentaire ?\")){\n\t\t\tconst url = new URLSearchParams();\n            url.append('id_message', this.props.id_message);\n            url.append('comId', id_commentaire);\n \t\t\taxios.get('http://localhost:8080/MochiCine/Comment/Delete?' + url).then(response => this.delete(response, index));\n\t\t}\n\t}\n\tdelete(rep, index){\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"message\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t  \t\t//Cela permet de faire une copie de notre liste de message:\n\t  \t\tconst newList = Object.assign([], this.state.comments);\n\t  \t\tnewList.splice(index,1);\n\t  \t\t//console.log(\"deleteCommentaire: \",newList);\n\t  \t\tthis.setState({comments: newList});\n\t  \t}\n\t}\n\n\tgetListCommentaires(){\n\t\t\treturn(\n\t\t\t\tthis.state.comments.map((item, index) => \n\t\t\t\t<li className=\"list-group-item\" key={item._id}>\n            \t\t<small className=\"date text-muted\">{item.date}</small>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<small className=\"list-group-item-heading text-primary\">{item.login}</small>\n\t\t\t\t\t\t<p className=\"list-group-item-text\">\n\t\t\t\t\t\t\t{item.text}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t{(this.props.login === item.login)? <button className=\"btn btn-sm corbeille\" onClick={()=> this.supprimerMessage(item._id, index)}><i className=\"fas fa-trash-alt\"></i></button> : <p></p>}\n\t\t\t\t\t</div>\n\n\t\t\t\t</li>\n\t\t\t\t\t));\n\t}\n\n\n\n\trender(){\n\t\tlet name = \"collapseCom\"+this.props.id_message;\n\t\tlet box;\n\t\t(this.props.isConnected === true)? box = <EcrireMessage addMessage={this.addComment.bind(this)} /> : box = <div></div>;\n\t\treturn(\n\t\t<div className=\"comments-group\" >\n\t\t\t<button className=\"btn fas fa-comment\" data-toggle=\"collapse\" data-target=\"#collapseCom\" aria-expanded=\"false\">\n\t\t\t</button>\n\t\t\t<div className=\"collapse\" id=\"collapseCom\">\n\t\t\t\t{this.getListCommentaires()}\n\t\t\t\t{box}\n\t\t\t</div>\n\t\t</div>\n);\n\t}\n}\n\nexport default Commentaires"]},"metadata":{},"sourceType":"module"}