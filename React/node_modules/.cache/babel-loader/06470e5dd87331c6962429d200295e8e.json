{"ast":null,"code":"var _jsxFileName = \"/home/neko/git/MochiCine/React/src/Commentaires.js\";\nimport React from 'react';\nimport axios from \"axios\";\nimport EcrireMessage from \"./EcrireMessage\";\n\nclass Message extends React.Component {\n  constructor(props) {\n    super(props); //login, titre\n\n    this.state = {\n      messages: [],\n      statut: \"\",\n      textError: \"\"\n    };\n    this.deleteMessage = this.deleteMessage.bind(this);\n  } //Mettre a jour s'il y a un changement dans la liste de commentaire\n\n\n  componentDidMount() {\n    this.setState({\n      messages: this.props.message\n    });\n  } //Gestion Commentaire:\n\n\n  addComment(comment) {\n    if (comment.length > 0) {\n      const url = new URLSearchParams();\n      url.append('user', this.props.login);\n      url.append('titre', this.props.titre);\n      url.append('comment', comment);\n      axios.get('http://localhost:8080/MochiCine/Comment/Add?' + url).then(response => this.updateComment(response));\n    }\n  }\n\n  updateComment(rep) {\n    //console.log(rep.data)\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"commentaire\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      let newList = this.state.comments;\n      newList.push(rep.data[\"commentaire\"]);\n      this.setState({\n        comments: newList\n      });\n    }\n  }\n\n  deleteMessage(id_commentaire, index) {\n    if (window.confirm(\"Voulez-vous supprimer ce commentaire ?\")) {\n      const url = new URLSearchParams();\n      url.append('user', this.props.login);\n      url.append('titre', this.props.titre);\n      url.append('comId', id_commentaire);\n      axios.get('http://localhost:8080/MochiCine/Comment/Delete?' + url).then(response => this.delete(response, index));\n    }\n  }\n\n  delete(rep, index) {\n    if (rep.data[\"code\"]) {\n      this.setState({\n        statut: \"error\",\n        textError: rep.data[\"message\"]\n      });\n      window.confirm(this.state.textError);\n    } else {\n      //Cela permet de faire une copie de notre liste de message:\n      const newList = Object.assign([], this.state.comments);\n      newList.splice(index, 1); //console.log(\"deleteCommentaire: \",newList);\n\n      this.setState({\n        comments: newList\n      });\n    }\n  }\n\n  render() {\n    let box;\n    this.props.isConnected === true ? box = /*#__PURE__*/React.createElement(EcrireMessage, {\n      addComment: this.addComment.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 44\n      }\n    }) : box = /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 110\n      }\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"liste_com\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 10\n      }\n    }, box, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 4\n      }\n    }), /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"list-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 4\n      }\n    }, this.state.comments.map((item, index) => /*#__PURE__*/React.createElement(\"div\", {\n      key: item.key,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 47\n      }\n    }))));\n  }\n\n}\n\nexport default Commentaires;","map":{"version":3,"sources":["/home/neko/git/MochiCine/React/src/Commentaires.js"],"names":["React","axios","EcrireMessage","Message","Component","constructor","props","state","messages","statut","textError","deleteMessage","bind","componentDidMount","setState","message","addComment","comment","length","url","URLSearchParams","append","login","titre","get","then","response","updateComment","rep","data","window","confirm","newList","comments","push","id_commentaire","index","delete","Object","assign","splice","render","box","isConnected","map","item","key","Commentaires"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from \"axios\";\nimport EcrireMessage from \"./EcrireMessage\";\n\n\n\nclass Message extends React.Component {\n\tconstructor(props){\n    \tsuper(props); //login, titre\n    \tthis.state={messages:[], statut:\"\", textError:\"\"};\n    \tthis.deleteMessage=this.deleteMessage.bind(this);\n\t}\n\n\t//Mettre a jour s'il y a un changement dans la liste de commentaire\n\tcomponentDidMount(){\n\t\tthis.setState({messages: this.props.message});\n\t}\n\n\t//Gestion Commentaire:\n\taddComment(comment){\n\t\tif(comment.length >0){\n\t\t\tconst url = new URLSearchParams();\n \t\t\turl.append('user',this.props.login);\n \t\t\turl.append('titre', this.props.titre);\n \t\t\turl.append('comment', comment);\n \t\t\taxios.get('http://localhost:8080/MochiCine/Comment/Add?' + url).then(response => this.updateComment(response));\n\t\t}\n\t}\n\tupdateComment(rep){\n\t\t//console.log(rep.data)\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"commentaire\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t  \t\tlet newList = this.state.comments;\n\t  \t\tnewList.push(rep.data[\"commentaire\"])\n\t\t\tthis.setState({comments: newList});\n\t  \t}\n\t}\n\n\n\tdeleteMessage(id_commentaire, index){\n\t\tif(window.confirm(\"Voulez-vous supprimer ce commentaire ?\")){\n\t\t\tconst url = new URLSearchParams();\n            url.append('user',this.props.login);\n            url.append('titre', this.props.titre);\n            url.append('comId', id_commentaire);\n \t\t\taxios.get('http://localhost:8080/MochiCine/Comment/Delete?' + url).then(response => this.delete(response, index));\n\t\t}\n\t}\n\tdelete(rep, index){\n\t\tif(rep.data[\"code\"]){\n\t  \t\tthis.setState ({statut: \"error\", textError: rep.data[\"message\"]});\n\t  \t\twindow.confirm(this.state.textError);\n\t  \t}else{\n\t  \t\t//Cela permet de faire une copie de notre liste de message:\n\t  \t\tconst newList = Object.assign([], this.state.comments);\n\t  \t\tnewList.splice(index,1);\n\t  \t\t//console.log(\"deleteCommentaire: \",newList);\n\t  \t\tthis.setState({comments: newList});\n\t  \t}\n\t}\n\n\n\n\trender(){\n\t\tlet box;\n\t\t(this.props.isConnected === true)? box = <EcrireMessage addComment={this.addComment.bind(this)} /> : box = <div></div>;\n\t\treturn(<div className=\"liste_com\">\n\t\t\t{box}\n\t\t\t<span></span>\n\t\t\t<ul className=\"list-group\">\n\t\t\t\t{this.state.comments.map((item, index) => <div key={item.key} ></div>)}\n\t\t\t</ul>\n\t\t</div>);\n\t}\n}\n\nexport default Commentaires"]},"metadata":{},"sourceType":"module"}